OPENSTACK_PROG (?:[ a-zA-Z0-9_\-]+\.)+[ A-Za-z0-9_\-$]+

OPENSTACK_PROG_SINGLE [A-Za-z0-9_\-$]+

OPENSTACK_SOURCE %{OPENSTACK_PROG}|%{OPENSTACK_PROG_SINGLE}

OPENSTACK_REQ_LIST (\[(?:(req-%{UUID}|%{UUID}|%{BASE16NUM}|None|-|%{SPACE}))+\])?

OPENSTACK_PID ( %{POSINT:pid:int})?

OPENSTACK_LOGLEVEL ([D|d]ebug|DEBUG|[N|n]otice|NOTICE|[I|i]nfo|INFO|[W|w]arn?(?:ing)?|WARN?(?:ING)?|[E|e]rr?(?:or)?|ERR?(?:OR)?|[C|c]rit?(?:ical)?|CRIT?(?:ICAL)?|[F|f]atal|FATAL|[S|s]evere|SEVERE|[A|a]udit|AUDIT)

OPENSTACK_NORMAL %{TIMESTAMP_ISO8601:timestamp}%{OPENSTACK_PID} %{OPENSTACK_LOGLEVEL:loglevel} %{OPENSTACK_SOURCE:program} %{OPENSTACK_REQ_LIST:request_id_list} %{GREEDYDATA:msg}


RAW_TRACE (?:^[^0-9].*$|^$)

OPENSTACK_TRACE %{TIMESTAMP_ISO8601:timestamp} %{POSINT:pid:int} ([T|t]race|TRACE) %{OPENSTACK_SOURCE:program} %{GREEDYDATA:msg}|%{RAW_TRACE:msg}

OPENSTACK_MESSAGE %{OPENSTACK_NORMAL}|%{OPENSTACK_TRACE}

NOT_OVSW_SEPARATOR (?:[^|]*)

#
# Nova logs that have been passed through syslog
# Adaptation of SYSLOG5424LINE
#
SYSLOG5424PRINUM (?:\<%{NONNEGINT:syslog5424_pri}\>)

OPENSTACK_SYSLOGLINE %{SYSLOG5424PRINUM}%{CISCOTIMESTAMP:syslog_ts} %{HOSTNAME:syslog5424_host} %{OPENSTACK_MESSAGE:os_message}
GENERIC_SYSLOGLINE %{SYSLOG5424PRINUM}%{CISCOTIMESTAMP:syslog_ts} %{HOSTNAME:syslog5424_host} %{GREEDYDATA:msg}

NOVA_INSTANCE (?:\[instance: %{UUID:instance_id}\])
CLAIM_RSRC_PHYS (?:Total %{WORD:resource}: %{NUMBER:total:float} %{WORD}, used: %{NUMBER:used:float} %{WORD})
CLAIM_RSRC_VIRT (?:%{WORD:resource} limit: %{NUMBER:limit:float} %{WORD}, free: %{NUMBER:free:float} %{WORD})
CLAIM_REQ (?:Attempting claim: memory %{NUMBER:mem:float} MB, disk %{NUMBER:disk:float} GB, VCPUs %{NUMBER:cpu:float})
NOVA_INSTANCE_REQUEST %{NOVA_INSTANCE} %{CLAIM_REQ}
NOVA_CLAIMS_SUMMARY_PHYS %{NOVA_INSTANCE} %{CLAIM_RSRC_PHYS}
NOVA_CLAIMS_SUMMARY_VIRT %{NOVA_INSTANCE} %{CLAIM_RSRC_VIRT}

NOVA_SPAWN_START %{NOVA_INSTANCE} (?:Creating image)
NOVA_SPAWN_SUCCESS %{NOVA_INSTANCE} (?:Instance spawned successfully.)
NOVA_SPAWN_ABORT %{NOVA_INSTANCE} (?:aborted: Instance was deleted during spawn.)
NOVA_SPAWN_FAIL %{NOVA_INSTANCE} (?:Setting instance to ERROR state.)
#
# setting the field names to match the openstack log until I can figure out a better way of doing
# the search table
#
OPENVSWITCH_MESSAGE %{TIMESTAMP_ISO8601:timestamp}\|%{NUMBER:pid}\|%{NOT_OVSW_SEPARATOR:program}\|%{OPENSTACK_LOGLEVEL:loglevel}\|%{GREEDYDATA:msg}

LIBVIRT_MESSAGE %{TIMESTAMP_ISO8601:timestamp}: %{NUMBER:pid}: %{OPENSTACK_LOGLEVEL:loglevel} : %{GREEDYDATA:msg}

APACHE_LOG_LEVEL (?:emerg|alert|crit|error|warn|notice|info|debug)

APACHE_DATETIME_ERROR %{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{YEAR}

RABBITMQ_DATE %{MONTHDAY}-%{MONTH}-%{YEAR}::%{TIME}

MYSYSLOG5424LINE %{SYSLOG5424PRI:syslog5424_pri}%{NONNEGINT:syslog5424_ver} (%{TIMESTAMP_ISO8601:syslog5424_ts}|-) (%{HOSTNAME:syslog5424_host}|-) (%{WORD:syslog5424_app}|-) (%{WORD:syslog5424_proc}|-) (%{WORD:syslog5424_msgid}|-) %{GREEDYDATA:syslog5424_msg}

OS_NODEINFO cpu_model=%{WORD:cpu_model},mem_mbytes=%{NONNEGINT:mem_mbytes:int},total_vcpus=%{NONNEGINT:total_vcpus:int},cpu_mhz=%{NONNEGINT:cpu_mhz:int},threads_per_core=%{NONNEGINT:threads_per_core:int},cpu_sockets=%{NONNEGINT:cpu_sockets:int},cores_per_socket=%{NONNEGINT:cores_per_socket:int},numa_cells=%{NONNEGINT:numa_cells:int},total_vms=%{NONNEGINT:total_vms:int},active_vms=%{NONNEGINT:active_vms:int},inactive_vms=%{NONNEGINT:inactive_vms:int},active_vcpus=%{NONNEGINT:active_vcpus:int},active_mem_allocated=%{NONNEGINT:active_mem_allocated:int},active_mem_used=%{NONNEGINT:active_mem_used:int},inactive_vcpus=%{NONNEGINT:inactive_vcpus:int},inactive_mem=%{NONNEGINT:inactive_mem:int}%{GREEDYDATA}
